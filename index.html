<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>쿠폰 번호 스캐너</title>
    <link rel="stylesheet" href="style.css">
    <script src='https://unpkg.com/tesseract.js@5/dist/tesseract.min.js'></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>쿠폰 번호 스캐너 🎟️</h1>
            <div class="settings">
                <div>
                    <label for="coupon-length">쿠폰 자릿수 (예: 12 또는 8-16):</label>
                    <input type="text" id="coupon-length" value="8-16">
                </div>
                {/* === 쿠폰 형식 선택 추가 === */}
                <div>
                    <label for="coupon-format">쿠폰 형식:</label>
                    <select id="coupon-format">
                        <option value="alphanumeric" selected>영문/숫자</option>
                        <option value="alphanumeric_hyphen">영문/숫자 + 하이픈 포함</option>
                    </select>
                </div>
                {/* === 쿠폰 형식 선택 추가 끝 === */}
                <div>
                    <label for="recognition-mode">인식 모드:</label>
                    <select id="recognition-mode">
                        <option value="manual" selected>👆 수동 촬영</option>
                        <option value="auto">🤖 자동 인식 (준비 중)</option>
                    </select>
                </div>
            </div>
        </header>

        <main>
            <div class="scanner-area">
                <video id="camera-feed" playsinline autoplay muted></video>
                <div class="scan-window-overlay">
                    <div class="scan-window"></div>
                </div>
                <canvas id="capture-canvas" style="display:none;"></canvas>
            </div>

            <div class="controls">
                <button id="capture-btn">쿠폰 읽기 📸</button>
                {/* <button id="auto-capture-toggle-btn" style="display:none;">자동 인식 시작 ▶️</button> */}
            </div>

            <div class="result-area">
                <h2>인식된 번호 후보:</h2>
                <p id="ocr-status">카메라를 준비 중입니다...</p>
                <div id="ocr-raw-debug-output" style="font-size: 0.85em; color: #007bff; margin-bottom: 8px; padding: 5px; background-color: #e9ecef; border-radius: 3px; word-break: break-all;"></div>
                <div id="temp-result-display">
                    <span id="recognized-code-candidate"></span>
                    <button id="add-to-list-btn" style="display:none;">이 번호로 목록에 추가</button>
                </div>
            </div>

            <div class="coupon-list-area">
                <h2>저장된 쿠폰 목록 <span id="coupon-count">(0개)</span></h2>
                <ul id="coupon-list">
                    {/* 저장된 쿠폰이 여기에 추가됩니다 */}
                </ul>
                <div class="export-share-buttons">
                    <button id="copy-all-btn">📋 전체 목록 클립보드 복사</button>
                    <button
